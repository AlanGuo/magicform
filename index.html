
<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="keywords" content="魔法,表单">
	<meta name="author" content="alan">
	<meta name="description" content="魔法表单,表单的自动生成以及交互">
	<link rel="stylesheet" type="text/css" href="http://115.29.195.88:93/css/default/component.css?max-age=0">
	<link rel="stylesheet" type="text/css" href="http://115.29.195.88:93/css/snowball/component.css?max-age=0">
	<link rel="stylesheet" type="text/css" href="http://115.29.195.88:93/css/blackworld/component.css?max-age=0">
	<link rel="stylesheet" type="text/css" href="http://115.29.195.88:93/css/predefined-common.css?max-age=0">
	<link rel="stylesheet" type="text/css" href="http://115.29.195.88:93/css/predefined-form.css?max-age=0">
	<title>MagicForm</title>
	<style type="text/css">
	.mainview{
		width: 980px;
	}
	</style>
</head>
<body class="confui default">
	<header>
		<nav class="tc mt20">
			<a class="listlink current" href="#main" title="主页">主页</a>
			<a class="ml30 listlink p15" href="docs/index.html" target="_blank" title="文档">文档</a>
			<a class="ml30 listlink p15" href="https://github.com/AlanGuo/magicform" target="_blank" title="Github">Github</a>
		</nav>
	</header>
	<section class="mt80">
		<div class="tc">
			<img src="./assets/logo/magicform.png" width="200">
		</div>
		<div class="mainview marginauto mt20 clearfix">
			<div class="fl w600">
				<form class="mf">
					<fieldset>
						<div class="legend">From</div>
						<div class="content" id="form"></div>
					</fieldset>
					<ul>
						<li class="mt30" data-click-event="formstyle">
							<label class="fb">form样式</label>
							<input class="ml50 pointer" type="radio" data-theme="default" id="default" name="formstyle" checked="checked">
							<label class="ml10 pointer" data-theme="default" for="default">default</label>
							<input class="ml50 pointer" type="radio" data-theme="snowball" id="snowball" name="formstyle">
							<label class="ml10 pointer" data-theme="snowball" for="snowball">snowball</label>
							<input class="ml50 pointer" type="radio" data-theme="blackworld" id="blackworld" name="formstyle">
							<label class="ml10 pointer" type="radio" data-theme="blackworld" for="blackworld">blackworld</label>
						</li>
						<li class="mt30" data-click-event="labelpos">
							<label class="fb">label位置</label>
							<input class="ml50 pointer" type="radio" id="left" name="labelpos" checked="checked">
							<label class="ml10 pointer" for="left">左侧</label>
							<input class="ml50 pointer" type="radio" id="top" name="labelpos">
							<label class="ml10 pointer" for="top" >上方</label>
							<input class="ml50 pointer" type="radio" id="none" name="labelpos">
							<label class="ml10 pointer" for="none" >无</label>
						</li>
					</ul>
				</form>
			</div>
			<div class="fl mt30">
				<div>
					<button title="提取数据" data-click-event="html2json">-></button>
				</div>
				<div>
					<button title="生成表单" data-click-event="json2html"><-</button>
				</div>
			</div>
			<div class="fl">
				<fieldset>
					<legend>Code</legend>
					<textarea class="w300" style="height:280px" id="jsonText"></textarea>
				</fieldset>
			</div>
		</div>
	</section>
	<footer class="footer">
		Alan © 2013/07/10
	</footer>
	<script type="text/javascript" src="./assets/scripts/speedframe-0.1.js"></script>
	<script type="text/javascript" src="./release/magicform-0.0.1.js"></script>
	<script type="text/javascript">

		//纯数据
		var pureJson = {
			email:"ggddll123@qq.com",
			username:"alan",
			password:"1234567",
			message:""
		};

		//attach数据
		var jsonObj = {
			email:{mf:1,control:"text",validation:"required pattern='.*@.*'",placeholder:"email"},
			password:{mf:1,control:"password",validation:"minlength=6 required",placeholder:"password"},
			username:{mf:1,validation:"required maxlength=10 minlength=4",placeholder:"username"},
			message:{mf:1,placeholder:"leave a short message",control:"textarea",placeholder:"please enter a text"}
		};

		var g_options = {
			status:"editable",
			hasbuttons:false
		};

		var form = document.getElementById("form");
		var jsonText = document.getElementById("jsonText");


		jsonText.value = JSON.stringify(pureJson,undefined,2);

		var json2html = function(options){
			var json = pureJson;
			try{
				json = JSON.parse(jsonText.value);
			}
			catch(e){}

			g_options = options || g_options;
			magicform.generate(form,magicform.attach(json,jsonObj),g_options);
		};

		//初始化
		json2html();

		speedframe.event.register(document.body,"click",{
			"html2json":function(evt){
				jsonText.value = JSON.stringify(magicform.detach(magicform.html2json(form),jsonObj),undefined,2);
			},
			"json2html":function(evt){
				json2html(g_options);
			},
			"formstyle":function(evt){
				var target = evt.target;
				var theme = target.getAttribute("data-theme");

				if(theme){
					var bootstrapLinks = Array.prototype.slice(document.head.querySelectorAll(".bootstrap"));
					bootstrapLinks.forEach(function(item){
						document.head.removeChild(item);
					});
					//confui
					document.body.className = "confui "+theme;
				}
			},
			"labelpos":function(evt){
				var target = evt.target;
				var pos = target.id;
				if(pos === "top"){
					json2html({
						status:"editable",
						hasbuttons:false,
						classname:{
							label:"w20p align-left",
							control:"w100p"
						}
					});
				}
				else if(pos === "left"){
					json2html({
						status:"editable",
						hasbuttons:false
					});
				}
				else if(pos === "none" ){
					json2html({
						status:"editable",
						hasbuttons:false,
						classname:{
							label:"none",
							control:"w100p"
						}
					});
				}
			}
		});
	</script>
</body>
</html>