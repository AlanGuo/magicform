<template name="MFFormTemplate">
	<%var flag=false;for(var i in order){var p = order[i].p;
		if(!data[p].inline){%>
			<%if(flag){%>
				<%if(data[p].hash){%>
					</div><div><%=util.tmpl(labelItemTemplate,{data:data,options:options,p:p})%><%=util.tmpl(valueItemTemplate,{data:data[p].key,flag:true,options:options,listitem:"",p:p})%><span class="formitem-ml10"></span>
				<%}else{%>
					</div><div class="<%=options.classname.itemwrapper%>" style="<%=options.style.itemwrapper%>"><%=util.tmpl(labelItemTemplate,{data:data,options:options,p:p})%>
				<%}%>
			<%}else{flag=true;%>
				<%if(data[p].hash){%>
					<%=util.tmpl(labelItemTemplate,{data:data,options:options,p:p})%><%=util.tmpl(valueItemTemplate,{data:data[p].key,flag:true,options:options,listitem:"",p:p})%><span class="formitem-ml10"></span>
				<%}else{%>
					<div class="<%=options.classname.itemwrapper%>" style="<%=options.style.itemwrapper%>"><%=util.tmpl(labelItemTemplate,{data:data,options:options,p:p})%>
				<%}%>
			<%}%>
		<%}else if(data[p].hash){%>
			<div><%=util.tmpl(labelItemTemplate,{data:data,options:options,p:p})%></div><%=util.tmpl(valueItemTemplate,{data:data[p].key,flag:true,options:options})%><span class="formitem-ml10"></span>
		<%}else{%>
			<%=util.tmpl(labelItemTemplate,{data:data,options:options,p:p})%>
		<%}%>
		<%if(/array/i.test(Object.prototype.toString.call(data[p]))){%>
			<!--key-array-->
			<span class="form-array-ul <%=data[p].classname?data[p].classname.control:options.classname.control%>" type="array">
				<%if(options.status == "editable" || options.status == "new"){%>
				<a href="javascript:;" class="form-icon form-item-add" title="新增" data-newtemplate="<%=encodeURIComponent(JSON.stringify(data[p].filter(function(item){if(item.fornew) return item;})[0]))%>"><i class="mf-iconfont">&#xf0154;</i></a>
				<%}%>
				<%if(options.status != "new"){%>
					<%for(var i=data[p].length-1;i>=0;i--){%>
						<%if(!data[p][i].fornew){%>
							<br>
							<%if(data[p][i].hash){%>
								<span class="form-array-li w45p"><%=util.tmpl(valueItemTemplate,{data:data[p][i].key,flag:true,options:options,listitem:"listitem",p:p})%></span>
								<span class="form-array-li w50p"><%=util.tmpl(valueItemTemplate,{data:data[p][i],flag:true,options:options,listitem:"",p:p})%>
							<%}else{%>
							<span class="form-array-li"><%=util.tmpl(valueItemTemplate,{data:data[p][i],flag:true,options:options,listitem:"listitem",p:p})%>
							<%}%>
							<%if(options.status == "editable" || options.status == "new"){%>
								<a href="javascript:;" class="form-icon form-item-remove" title="移除"><i class="mf-iconfont">&#xf0153;</i></a>
							<%}%>
							</span>
						<%}%>
					<%}%>
				<%}%>
			</span>
		<%}else if("[object Object]" === Object.prototype.toString.call(data[p]) && !data[p].mf || data[p].mf && data[p].isobject){%>
			<!--key-object-->
			<a href="javascript:;" class="form-icon form-item-detail formitem-control" for="formitem-<%=p%>" data-mf-val="<%=encodeURIComponent(JSON.stringify(data[p]))%>" title="详细设定"><i class="mf-iconfont">&#xf00e1;</i></a>
		<%}else{%>
			<!--key-value-->
			<%=util.tmpl(valueItemTemplate,{data:data[p],flag:true,options:options,listitem:"",p:p})%>
		<%}%>
	<%}%>
	<%if(options.hasbuttons && (options.status == "editable" || options.status == "new")){%>
		<%=util.tmpl(formpanelTemplate,{options:options})%>
	<%}%>
</template>

<template name="MFFormLabelItemTemplate">
	<label class="<%=data[p].classname?data[p].classname.label:options.classname.label%>" style="<%=data[p].style?data[p].style.label:options.style.label%>" for="formitem-<%=p%>" data-key="formitem-<%=p%>"><%=data[p].label?data[p].label:p%></label>
</template>

<template name="MFFormValueItemTemplate">
	<%if(data.mf){%>
		<%if(data.control === "radio"){%>
			<span class="formitem-radio" type="radio" data-order="<%=data.order%>">
				<%for(var i=0;i<data.options.length;i++){%>
					<input data-listitem="<%=listitem%>" class="formitem-radio" <%=options.status=="disabled" ? "disabled": ""%> placeholder="<%=data.options[i].placeholder?data.options[i].placeholder:""%>" data-flag="<%=flag%>" <%=data.options[i].validation%> <%=data.options[i].disabled%> type="radio" <%=options.status=="new" ? "" : data.options[i].checked%> data-order="<%=data.order%>" name="<%=data.name%>" id="formitem-radio-<%=data.options[i].label%>"><label class="formitem-radio-label" for="formitem-radio-<%=data.options[i].label%>"><%=data.options[i].label%></label>
				<%}%>
			</span>
		<%}else if(data.control === "checkbox"){%>
			<span class="formitem-checkbox" type="checkbox" data-order="<%=data.order%>">
				<%for(var i=0;i<data.options.length;i++){%>
					<input data-listitem="<%=listitem%>" class="formitem-checkbox" placeholder="<%=data.options[i].placeholder?data.options[i].placeholder:""%>" <%=options.status=="disabled" ? "disabled": ""%> <%=data.options[i].disabled%> <%=data.options[i].validation%> data-flag="<%=flag%>" type="checkbox" <%=options.status=="new" ? "" : data.options[i].checked%> id="formitem-radio-<%=data.options[i].label%>"><label for="formitem-radio-<%=data.options[i].label%>" class="formitem-checkbox-label"><%=data.options[i].label%></label>
				<%}%>
			</span>
		<%}else if(data.control==="select"){var flag=false;%>
			<select data-listitem="<%=listitem%>" id="formitem-<%=p%>" class="<%=data.classname?data.classname.control:options.classname.control%> formitem-select" style="<%=data.style?data.style.control:options.style.control%>" <%=options.status=="disabled" ? "disabled": ""%> data-flag="<%=flag%>" <%=data.validation%> <%=data.disabled%> data-order="<%=data.order%>">
				<%for(var i=0;i<data.options.length;i++){%>
					<%if(data.options[i].val==="optgroup"){%>
						<%if(flag){%>
							</optgroup>
							<optgroup label="<%=data.options[i].text%>" class="formitem-selectoption formitem-selectoptiongroup">
						<%}else{flag=true;%>
							<optgroup label="<%=data.options[i].text%>" class="formitem-selectoption formitem-selectoptiongroup">
						<%}%>
					<%}else{%>
						<option value="<%=data.options[i].val%>" class="formitem-selectoption"><%=data.options[i].text%></option>
					<%}
				}%>
			</select>
		<%}else if(data.control === "textarea"){%>
			<textarea data-listitem="<%=listitem%>" id="formitem-<%=p%>" class="<%=data.classname?data.classname.control:options.classname.control%> formitem-input" style="<%=data.style?data.style.control:options.style.control%>" <%=options.status=="disabled" ? "disabled": ""%> placeholder="<%=data.placeholder?data.placeholder:""%>" data-flag="<%=flag%>" <%=data.validation%> <%=data.disabled%> data-order="<%=data.order%>" type="<%=data.control%>"><%=options.status=="new" ? "" : data.value%></textarea>
		<%}else{%>
			<input data-listitem="<%=listitem%>" id="formitem-<%=p%>" class="<%=data.classname?data.classname.control:options.classname.control%> formitem-input" style="<%=data.style?data.style.control:options.style.control%>" placeholder="<%=data.placeholder?data.placeholder:""%>" <%=options.status=="disabled" ? "disabled": ""%> data-flag="<%=flag%>" <%=data.validation%> <%=data.disabled%> data-order="<%=data.order%>" type="<%=data.control%>" value="<%=options.status=="new" ? "" : data.value%>">
		<%}%>
	<%}else{%>
		<!--key-value-->
		<input data-listitem="<%=listitem%>" id="formitem-<%=p%>" class="<%=data.classname?data.classname.control:options.classname.control%> formitem-input" style="<%=data.style?data.style.control:options.style.control%>" <%=options.status=="disabled" ? "disabled": ""%> data-flag="<%=flag%>" <%=data.validation%> value="<%=options.status=="new" ? "" : data%>">
	<%}%>
</template>

<template name="MFFormPanelTemplate">
	<div class="<%=options.classname.formpanel%>">
		<label class="<%=options.classname.label%>" style="<%=options.style.label%>"></label>
		<%for(var i=0;i<options.buttons.length;i++){%>
			<%if(options.buttons[i].submit){%>
				<button class="<%=options.buttons[i].className%>" title="<%=options.buttons[i].title%>"><%=options.buttons[i].name%></button>
			<%}else{%>
				<button class="ml15 <%=options.buttons[i].className%>" title="<%=options.buttons[i].title%>"><%=options.buttons[i].name%></button>
			<%}%>
		<%}%>
	</div>
</template>

<template name="MFFormArrayItemTemplate">
	<br>
	<%if(data.hash){%>
		<span class="form-array-li w45p"><%=util.tmpl(valueItemTemplate,{data:data.key,flag:true,options:options,listitem:"listitem",p:data.p})%></span>
		<span class="form-array-li w50p">
			<%=util.tmpl(valueItemTemplate,{data:data,flag:false,options:options,listitem:"",p:data.p})%>
			<%if(options.status == "editable" || options.status == "new"){%>
				<a href="javascript:;" class="form-icon form-item-remove" title="移除"><i class="mf-iconfont">&#xf0153;</i></a>
			<%}%>
		</span>
	<%}else{%>
		<span class="form-array-li">
			<%=util.tmpl(valueItemTemplate,{data:data,flag:false,options:options,listitem:"listitem",p:data.p})%>
			<%if(options.status == "editable" || options.status == "new"){%>
				<a href="javascript:;" class="form-icon form-item-remove" title="移除"><i class="mf-iconfont">&#xf0153;</i></a>
			<%}%>
		</span>
	<%}%>
</template>